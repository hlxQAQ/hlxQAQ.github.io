[{"title":"[noip2013] è´§è½¦è¿è¾“","url":"/2019/04/20/noip2013-è´§è½¦è¿è¾“/","content":"### 1.1ã€é¢˜ç›®ã€‘\nAå›½æœ‰nåº§åŸå¸‚ï¼Œç¼–å·ä»Â 1åˆ°nï¼ŒåŸå¸‚ä¹‹é—´æœ‰Â mÂ æ¡åŒå‘é“è·¯ã€‚æ¯ä¸€æ¡é“è·¯å¯¹è½¦è¾†éƒ½æœ‰é‡é‡é™åˆ¶ï¼Œç®€ç§°é™é‡ã€‚ç°åœ¨æœ‰Â qÂ è¾†è´§è½¦åœ¨è¿è¾“è´§ç‰©ï¼Œ å¸æœºä»¬æƒ³çŸ¥é“æ¯è¾†è½¦åœ¨ä¸è¶…è¿‡è½¦è¾†é™é‡çš„æƒ…å†µä¸‹ï¼Œæœ€å¤šèƒ½è¿å¤šé‡çš„è´§ç‰©ã€‚\nç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•°n,mï¼Œæœ‰nÂ åº§åŸå¸‚å’ŒÂ mÂ æ¡é“è·¯ã€‚\næ¥ä¸‹æ¥Â mè¡Œæ¯è¡Œ3ä¸ªæ•´æ•°Â x, y, zï¼Œè¡¨ç¤ºä»Â xå·åŸå¸‚åˆ°yå·åŸå¸‚æœ‰ä¸€æ¡é™é‡ä¸ºÂ zçš„é“è·¯ã€‚ï¼ˆæ³¨æ„ï¼šÂ xÂ ä¸ç­‰äºÂ yï¼Œä¸¤åº§åŸå¸‚ä¹‹é—´å¯èƒ½æœ‰å¤šæ¡é“è·¯Â ã€‚ï¼‰\næ¥ä¸‹æ¥ä¸€è¡Œæœ‰ä¸€ä¸ªæ•´æ•° qï¼Œè¡¨ç¤ºæœ‰ q è¾†è´§è½¦éœ€è¦è¿è´§ã€‚\næ¥ä¸‹æ¥ q è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° xã€yï¼Œä¹‹é—´ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ï¼Œè¡¨ç¤ºä¸€è¾†è´§è½¦éœ€è¦ä» x åŸå¸‚è¿è¾“è´§ç‰©åˆ° y åŸå¸‚ï¼Œæ³¨æ„ï¼šÂ x ä¸ç­‰äº yÂ ã€‚\næ¯è¡Œä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ¯ä¸€è¾†è´§è½¦æœ€å¤§è½½é‡ã€‚å¦‚ä¸èƒ½åˆ°è¾¾ï¼Œè¾“å‡º-1ã€‚\n[æ´›è°· P1967][1]\n***\n\n### 1.2ã€åŸºæœ¬æ€è·¯ã€‘\næœ€å¤§ç”Ÿæˆæ ‘+ æ ‘å‰–LCA\nå¦‚ä½•ç”¨æ ‘å‰–æ±‚ä¸¤ç‚¹æƒå€¼æœ€å°\nåœ¨æ ‘å‰–ä¸€ç•ªè¹‚èºä¹‹ä¸‹å†³å®šæ”¹ç”¨å€å¢ é¡ºä¾¿å’Œä»æ²¡å†™è¿‡çš„å€å¢LCAåŸ¹å…»ä¸€ä¸‹æ„Ÿæƒ…\nâ€”â€”äºæ˜¯æ€è·¯å˜æˆäº†\næœ€å¤§ç”Ÿæˆæ ‘+ å€å¢LCA ğŸ˜€\n\n***\n\n### 1.3ã€ç¬”è®°ã€‘\nå…ˆç ä¸Šæœ€å¤§ç”Ÿæˆæ ‘æ¨¡æ¿ï¼Œæ˜¾ç„¶å›¾å¯èƒ½ä¸è”é€šï¼Œäºæ˜¯å¯¹æ¯ä¸€æ£µæ ‘éƒ½è¿›è¡ŒLCAï¼Œæå€¼çš„æŸ¥è¯¢å³åœ¨å€å¢çš„åŒæ—¶ç»´æŠ¤ä¸€ä¸ªæœ€å°æ•°ç»„ï¼Œè®°å½•è¿™æ®µè·¯ç¨‹ä¸­çš„æœ€å°è·¯å¾„å€¼\n\tâ€¢ æŸ¥æ‰¾æ¯æ£µæ ‘å³æšä¸¾æ‰€æœ‰ç«¯ç‚¹ï¼Œå°†æ¯ä¸ªå¹¶æŸ¥é›†çš„æœ€å¤§ç¥–å…ˆï¼ˆf [i] = iï¼‰éƒ½è¿›è¡Œä¸€éé¢„å¤„ç†\n\tâ€¢ LCAæ—¶ä¸è¦å¿˜è®°æœ€åæ¯”è¾ƒx,yä¸çˆ¶èŠ‚ç‚¹çš„è¾¹çš„æƒå€¼ï¼ï¼ï¼\n\tâ€¢ å¿˜çœ‹æ•°æ®èŒƒå›´REå‡ºå¥‡è¿¹(._. )\n\tâ€¢ poä¸€ä¸‹å¡äº†å¾ˆä¹…çš„LCAæ±‚è·¯å¾„æœ€å€¼éƒ¨åˆ†\n```\ninline int lca2(int x,int y){\nÂ Â Â Â Â Â Â Â int ans=1e7;\nÂ Â Â Â Â Â Â Â if(deep[x]>deep[y])swap(x,y);\nÂ Â Â Â Â Â Â Â for(int i=20;i>=0;i--){\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if(deep[fa[y][i]]>=deep[x])ans=min(minn[y][i],ans),y=fa[y][i];\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if(x==y)return ans;\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â for(int i=20;i>=0;i--){\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if(fa[x][i]!=fa[y][i])\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ans=min(minn[x][i],ans),ans=min(minn[y][i],ans),\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â x=fa[x][i],y=fa[y][i];\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â \nÂ Â Â Â Â Â Â Â return min(min(minn[x][0],minn[y][0]),ans);\n}\n```\n***\n### 1.4ã€å€å¢æ¿å­ã€‘\näº‹å®ä¸Šè¿˜æ˜¯ç¬¬ä¸€æ¬¡å†™å€å¢LCA\näºæ˜¯è¿™é‡Œpoä¸€ä¸‹å€å¢æ¨¡æ¿åŠä¼ªä»£ç \n```\n è°ƒç”¨ pre_treat(begin,begin) \t//æš‚æ—¶ä¸æ¸…æ¥šå’Œpre_treat(begin,0)æœ‰ä»€ä¹ˆåŒºåˆ«\nvoid pre_treat (int å½“å‰èŠ‚ç‚¹,int çˆ¶èŠ‚ç‚¹)\n\tdeep[å½“å‰èŠ‚ç‚¹]=depe[çˆ¶]+1ï¼›\n\tfa[å½“å‰èŠ‚ç‚¹][0]=ä»è¿™é‡Œå‘ä¸Šè·³ä¸€æ­¥=ä»–çˆ¸çˆ¸ï¼›\n\tfor ( int i=1 to 20\n\t      fa [ å½“å‰èŠ‚ç‚¹ ][ i ]=fa[ä»è¿™é‡Œå‘ä¸Šè·³2^(i-1)çš„èŠ‚ç‚¹][å†å‘ä¸Šè·³2^(i-1)æ­¥]\n\tfor(int i=h[u]......)\n\t      v=e[i].to æšä¸¾ä¸‹ä¸€ä¸ªèŠ‚ç‚¹\n\t      if(è¿™èŠ‚ç‚¹ä¸æ˜¯ä»–çˆ¶äº²)pre_treat(int æœåˆ°çš„èŠ‚ç‚¹,int (å°†åšçˆ¸çˆ¸çš„)å½“å‰èŠ‚ç‚¹)\n\nvoid lca(int å‹äººa ,int å‹äººb)\n\tå°†å‹äººaå®šä¸ºæ·±åº¦æµ…çš„é‚£ä½ï¼›\n\tfor(int i= 20 to 0\n\t       if(å‹äººbå‘ä¸Šè·³2^iæ¬¡ä¹Ÿè·³ä¸åˆ°açš„å¤´ä¸Š)\n\t\tè¯·å‹äººbè¡¨æ¼”å‘ä¸Šè·³ï¼›\n\t       if(å¯å·§å‹äººbå’Œaè·‘åˆ°äº†åŒä¸€ç‚¹)\n\t\tç»“æŸï¼›\n\t }\n\t\t//è·³å‡ºè¯¥å¾ªç¯åï¼Œæ­¤æ—¶aä¸båº”è¯¥åœ¨åŒä¸€æ·±åº¦çš„ä¸åŒèŠ‚ç‚¹\n\n\tfor(int i=20 to 0\n\t       if(aå’ŒbåŒæ—¶å‘ä¸Š2^iä¸ªèŠ‚ç‚¹å´æœªç›¸é‡)\n\t\tå‘ä¸Šè·³ï¼›\n\t }\nå…¬å…±ç¥–å…ˆå³ å½“å‰å‹äººaå’Œbçš„çˆ¶èŠ‚ç‚¹\n```\n```\nvoid pre_treat(int u,int father){\n\tdeep[u]=deep[father]+1;\n\tf[u][0]=father;\n\tfor(int i=1;i<=20;i++){\n\t\tf[u][i]=f[f[u][i-1]][i-1];\n\t}\n\tfor(int i=h[u];i;i=e[i].nex){\n\t\tint v=e[i].to;\n\t\tif(v!=father)First(v,u);\n\t}\n}\ninline int lca(int a,int b){\n\tif(deep[a]>deep[b])swap(a,b);\n\tfor(int i=20;i>=0;i--){\n\t\tif(deep[f[b][i]]>=deep[a])\n\t\t\ty=f[b][i];\n\t\tif(a==b)return a;\n\t}\n\tfor(int i=20;i>=0;i--){\n\t\tif(f[a][i]!=f[b][i])\n\t\t\tx=f[a][i],y=f[b][i];\n\t}\n\t\n\treturn f[a][0];\n}\n```\n***\n### 1.5ã€å°ç»“ã€‘\nç”Ÿæˆæ ‘å’Œå€å¢æ¨¡æ¿+é¢å¤–ç»´æŠ¤ä¸€ä¸ªç­”æ¡ˆæ•°ç»„â€¦â€¦\nquqä¸ºå•¥å½“åˆæˆ‘å°±åšä¸å‡ºæ¥å‘¢\nä»¥åŠè¿˜æœ‰kruskalé‡æ„æ ‘+LCA , æ ‘å‰–+çº¿æ®µæ ‘ ç­‰è§£æ³•\n`ä»¥åè¦å¤šå¤šæ³¨æ„ç»†èŠ‚é—®é¢˜ã€‚`\n```\n#include<bits/stdc++.h>\n#define N 100010\nint n,f[N],cnt,k,m,q;\nstruct play{\n\tint x,y,l;\n};play h[N];\n\nstruct play2{\n\tint fr,to,w,nex;\n};play2 e[N];\nint fa[N][30],minn[N][30],num,he[N],deep[N];\n\nusing namespace std;\n\ninline bool cmp1(play a,play b){return a.l>b.l;}\ninline int find(int x){if(x!=f[x])f[x]=find(f[x]);\treturn f[x];}\ninline void merge(int x,int y){x=find(x),y=find(y);\tf[y]=x;}\ninline void add(int x,int y,int w){\n\te[++num].nex=he[x];\n\te[num].to=y;\n\te[num].fr=x;\n\te[num].w=w;\n\the[x]=num;\n}\ninline void First(int u,int father,int fre){\n\tdeep[u]=deep[father]+1;\n\tfa[u][0]=father;\n\tminn[u][0]=fre;\n\tfor(int i=1;i<=20;i++){\n\t\tfa[u][i]=fa[fa[u][i-1]][i-1];\n\t\tminn[u][i]=min(minn[fa[u][i-1]][i-1],minn[u][i-1]);////////...\n\t}\n\tfor(int i=he[u];i;i=e[i].nex){\n\t\tint vi=e[i].to;\n\t\tif(vi!=father)fa[vi][0]=u,First(vi,u,e[i].w);\n\t}\n}\ninline int lca2(int x,int y){\n\tint ans=1e7;\n\tif(deep[x]>deep[y])swap(x,y);\n\tfor(int i=20;i>=0;i--){\n\t\tif(deep[fa[y][i]]>=deep[x])\n\t\t\tans=min(minn[y][i],ans),y=fa[y][i];\n\t\tif(x==y)return ans;\n\t}\n\tfor(int i=20;i>=0;i--){\n\t\tif(fa[x][i]!=fa[y][i])\n\t\t\tans=min(minn[x][i],ans),\n\t\t\tans=min(minn[y][i],ans),\n\t\t\tx=fa[x][i],y=fa[y][i];\n\t}\n\t\n\treturn min(min(minn[x][0],minn[y][0]),ans);\n}\ninline void lca(){\n\tscanf(\"%d\",&q);\n\twhile(q--)\n\t{\n\t\tint a,b,c;\n\t\tscanf(\"%d%d\",&a,&b);\n\t\tif(find(a)!=find(b))\n\t\t{\n\t\t\tprintf(\"-1\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tc=lca2(a,b);\n\t\tif(c<=0||c>=1e7)printf(\"-1\\n\");\n\t\telse printf(\"%d\\n\",c);\n\t}\n}\ninline void scs(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=m;i++){\n\t\tcnt++;\n\t\tcin>>h[cnt].x>>h[cnt].y>>h[cnt].l;\n\t}\n\tfor(int i=1;i<=n;i++)f[i]=i;\n\tsort(h+1,h+1+m,cmp1);\n\tint tmp=min(n-1,m);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tif(find(h[i].x)!=find(h[i].y))\n\t\t{\n\t\t\tmerge(h[i].x,h[i].y);\n\t\t\tadd(h[i].x,h[i].y,h[i].l);\n\t\t\tadd(h[i].y,h[i].x,h[i].l);\n\t\t\tk++;\n\t\t\tif(k==tmp)break;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(f[i]==i) First(i,i,1e7);\n\t}\n}\nint main(){\n\tscs();\n\tlca();\n\treturn 0;\n}\n```\n\n  [1]: https://www.luogu.org/problemnew/show/P1967","tags":["noip","LCA","å€å¢","æœ€å°ç”Ÿæˆæ ‘"]},{"title":"RQMç®—æ³•","url":"/2019/03/10/RQMç®—æ³•/","content":"### å®šä¹‰\nRMQ (Range Minimum/Maximum Query)é—®é¢˜æ˜¯æ±‚åŒºé—´æœ€å€¼çš„é—®é¢˜ã€‚\n***\n### ä¸»è¦æ–¹æ³•   `å‡ä¸ºåœ¨çº¿ç®—æ³•`\n1ã€æœ´ç´ ï¼ˆå³æœç´¢ï¼‰ï¼ŒO(n)-O(qn) \n2ã€çº¿æ®µæ ‘ï¼ŒO(n)-O(qlogn) \n3ã€STï¼Œ(å®è´¨æ˜¯åŠ¨æ€è§„åˆ’ï¼‰O(nlogn)-O(q) \n4ã€RMQæ ‡å‡†ç®—æ³•ï¼Œå…ˆè§„çº¦æˆLCAï¼Œå†è§„çº¦æˆçº¦æŸRMQï¼ŒO(n)-O(q)\n***\n### çº¿æ®µæ ‘ç®—æ³•###\nç”¨çº¿æ®µæ ‘å®ç°çš„RMQç®—æ³•ä¸ä»…å¯ä»¥æŸ¥è¯¢åŒºé—´æœ€å€¼,è¿˜å¯ä»¥æ›´æ”¹æŸä¸ªèŠ‚ç‚¹çš„å€¼\n~~ç›´æ¥å¥—çº¿æ®µæ ‘æ¨¡æ¿~~\n***\n\n### RMQæ ‡å‡†ç®—æ³•\né¦–å…ˆæ ¹æ®åŸæ•°åˆ—ï¼Œå»ºç«‹ç¬›å¡å°”æ ‘ï¼Œä»è€Œå°†é—®é¢˜åœ¨çº¿æ€§æ—¶é—´å†…è§„çº¦ä¸ºLCAé—®é¢˜ã€‚LCAé—®é¢˜å¯ä»¥åœ¨çº¿æ€§æ—¶é—´å†…è§„çº¦ä¸ºçº¦æŸRMQï¼Œä¹Ÿå°±æ˜¯æ•°åˆ—ä¸­ä»»æ„ä¸¤ä¸ªç›¸é‚»çš„æ•°çš„å·®éƒ½æ˜¯+1æˆ–-1çš„RMQé—®é¢˜ã€‚çº¦æŸRMQæœ‰O(n)-O(1)çš„åœ¨çº¿è§£æ³•ï¼Œæ•…æ•´ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n)-O(1)ã€‚\n***\n### STç®—æ³•\nSTç®—æ³•ï¼ˆSparse Tableï¼‰ï¼Œä»¥æ±‚æœ€å¤§å€¼ä¸ºä¾‹ï¼Œd [ i , j ]è¡¨ç¤ºä»¥i ä¸ºèµ·ç‚¹çš„é•¿åº¦ä¸º 2^j çš„åŒºé—´  **[ i , i + 2^j - 1]** ï¼Œé‚£ä¹ˆåœ¨è¯¢é—®åˆ°[a,b]åŒºé—´çš„æœ€å¤§å€¼æ—¶ç­”æ¡ˆå°±æ˜¯ **max (   d [ a , k ],  d [ b - 2^k + 1 , k ]   )**ï¼Œkæ˜¯æ»¡è¶³ **2^k<=b-a+1** (å³é•¿åº¦)çš„æœ€å¤§çš„k,å³**k= [ ln ( b - a + 1 ) / ln( 2 ) ]**ã€‚\n`d[i,j]=max(d[i,j-1],d[i+2^(j-1),j-1])`\n\n```\nvoid rmq_init() /* é¢„å¤„ç† \n{ \n\tfor ( int i = 1; i <= N; i++ )\n\t  \tdp[i][0] = a[i];\n  \tfor ( int j = 1; j <= N; j++ )\n\t  \tfor ( int i = 1; i + (1 << j) - 1 <= N; i++ )\n\t\t  \tdp[i][j] = min( dp[i][j - 1], dp[i + 1 << (j - 1)][j - 1] );\n}\n```\n\n```\nvoid rmq( int l, int r )\n{\n\tint k = log2( r - l + 1 );\n\treturn(min( dp[l][k], dp[r - (l << k) + 1][k] ) );\n}\n```\n \n\n<br/><br/><br/><br/><br/><br/><br/><br/><br/>\n[å‚è€ƒ]\nç™¾ç§‘ <https://baike.baidu.com/item/RQM/9736833>\nOIWIKI <https://oi-wiki.org/ds/sparse-table/#rmq>\nrqmç®—æ³•çš„STå®ç° <https://www.cnblogs.com/YSFAC/p/7189571.html>","tags":["ç¬”è®°"]}]